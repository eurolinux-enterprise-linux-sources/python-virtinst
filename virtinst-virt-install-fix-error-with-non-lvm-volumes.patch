From 81c426dec056d82d44653791f2c0f856e25da139 Mon Sep 17 00:00:00 2001
From: Giuseppe Scrivano <gscrivan@redhat.com>
Date: Wed, 4 Mar 2015 12:45:13 +0100
Subject: [PATCH] virt-install: fix error with non-lvm volumes

Closes: https://bugzilla.redhat.com/show_bug.cgi?id=1198517

RHEL-only

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>
---
 virtinst/cli.py | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/virtinst/cli.py b/virtinst/cli.py
index 311c6c5..a0aed96 100644
--- a/virtinst/cli.py
+++ b/virtinst/cli.py
@@ -1475,8 +1475,9 @@ def _parse_disk_source(guest, path, pool, vol, size, fmt, sparse):
                                                               pool_name=pool,
                                                               name=guest.name,
                                                               suffix=".img")
+        cap = size and size * 1024 * 1024 * 1024
         volinst = vc(pool_name=pool, name=vname, conn=guest.conn,
-                     capacity=(size and size * 1024 * 1024 * 1024))
+                     allocation=cap, capacity=cap)
         if fmt:
             if not hasattr(volinst, "format"):
                 raise ValueError(_("Format attribute not supported for this "
-- 
2.1.0

